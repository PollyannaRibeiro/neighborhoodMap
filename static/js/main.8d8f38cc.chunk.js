(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{197:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(32),i=a.n(r),s=(a(85),a(18)),o=a(19),c=a(21),p=a(20),d=a(22),u=(a(86),function(e){function t(){var e,a;Object(s.a)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={query:""},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"onItemClick",value:function(e,t){this.props.onPlaceSelected(t)}},{key:"updateQuery",value:function(e){this.setState({query:e}),this.props.onQueryChanged(e)}},{key:"render",value:function(){var e=this,t=this.props.places,a="sidebar";return this.props.sidebarOpen&&(a="sidebar open"),n.a.createElement("div",{className:a,role:"navigation"},n.a.createElement("div",{className:"search-locations-bar"},n.a.createElement("div",{className:"search-locations-input-wrapper"},n.a.createElement("input",{"aria-label":"Search the museum name",type:"text",placeholder:"Search by museum name",value:this.state.query,onChange:function(t){return e.updateQuery(t.target.value)}}))),n.a.createElement("div",{className:"search-locations-results"},n.a.createElement("ul",{className:"locations-list"},t.map(function(t){return n.a.createElement("li",{className:"list","aria-label":t.name,key:t.id,onClick:function(a){return e.onItemClick(a,t)}},n.a.createElement("div",{className:"list-container"},n.a.createElement("div",{className:e.props.selectedPlace&&t.id===e.props.selectedPlace.id?"list-selected-title":"list-title"},t.name)))}))))}}]),t}(l.Component)),m=a(42),y=a(78),f=a.n(y),h=function(e){function t(){var e,a;Object(s.a)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).markers={},a.state={mapProps:null,map:null},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"onMapReady",value:function(e,t){this.setState({mapProps:e,map:t}),this.props.onMapLoaded(e,t)}},{key:"onMarkerClick",value:function(e){this.props.onPlaceSelected(e)}},{key:"onMapClicked",value:function(){this.props.selectedPlace&&this.props.onPlaceSelected(null)}},{key:"render",value:function(){var e=this,t=this.props.places,a=this.props.selectedPlace,l=this.props.selectedPlaceDetails,r=a?a.name:"",i=null;if(this.state.mapProps){var s=this.state.mapProps.google,o=this.state.map,c=new Set(Object.keys(this.markers));t.forEach(function(t){var n=e.markers[t.id];if(!n){var r=new s.maps.Marker({position:t.geometry.location,title:t.name,name:t.name,animation:s.maps.Animation.DROP});r.setMap(o),r.addListener("click",function(){e.onMarkerClick(t)}),e.markers[t.id]=r}return c.delete(t.id),a&&t.id===a.id&&(i=n,l?n.setAnimation(null):n.setAnimation(s.maps.Animation.BOUNCE)),n}),c.forEach(function(t){e.markers[t].setMap(null),delete e.markers[t]})}var p=null;return l&&l.photos&&l.photos.length>0&&(p=l.photos[0].getUrl()),n.a.createElement(m.Map,{className:"map",role:"application",tabindex:"1",google:this.props.google,zoom:15,initialCenter:{lat:51.51,lng:-.11},options:{styles:[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"administrative.neighborhood",elementType:"geometry.fill",stylers:[{weight:6}]},{featureType:"administrative.neighborhood",elementType:"geometry.stroke",stylers:[{visibility:"off"},{weight:3.5}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#5782ac"},{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.attraction",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",elementType:"labels.text.fill",stylers:[{color:"#9e9331"},{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"},{visibility:"on"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"},{weight:3.5}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}]},onClick:this.onMapClicked.bind(this),onReady:this.onMapReady.bind(this)},n.a.createElement(m.InfoWindow,{marker:i,visible:null!=l},n.a.createElement("div",null,n.a.createElement("h2",null,r),l&&n.a.createElement("div",{className:"museum-info"},l.rating&&n.a.createElement("p",null,"Rating: ",l.rating),l.wikiUrl&&n.a.createElement("a",{href:l.wikiUrl},n.a.createElement("img",{src:f.a,alt:"Wikipedia",className:"wikipedia-logo"})),l.formatted_phone_number&&n.a.createElement("p",null,"Phone: ",l.formatted_phone_number),n.a.createElement("p",null,"Address: ",l.formatted_address),p&&n.a.createElement("img",{className:"museum-img",src:p,width:"400",alt:r}),n.a.createElement("p",null,l.wikiDescription)))))}}]),t}(l.Component),g=Object(m.GoogleApiWrapper)({apiKey:"AIzaSyCBp9p14TKgr-Zlq4aNz6ZRxCsusD7hR6Q"})(h),b=a(79),v=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.sidebarOpen?"#ffffff":"#a2a2a2";return n.a.createElement(b.Slider,{onClick:this.props.onMenuClick,color:e,borderRadius:7,padding:"10px"})}}]),t}(l.Component),k=function(e){function t(){var e,a;Object(s.a)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={google:null,selectedPlace:null,selectedPlaceDetails:null,places:[],filteredPlaces:[],sidebarOpen:!0,showingError:!1},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"onMapLoaded",value:function(e,t){var a=e.google,l=new a.maps.places.PlacesService(t);var n={location:new a.maps.LatLng(51.51,-.11),radius:"1000",type:["museum"]};l.nearbySearch(n,function(l,n){var r=n===a.maps.places.PlacesServiceStatus.OK,i=r?l:null;this.setState({google:{mapProps:e,map:t},selectedPlace:null,selectedPlaceDetails:null,places:i,filteredPlaces:i,sidebarOpen:!0,error:!r})}.bind(this))}},{key:"updateQuery",value:function(e){var t=this.state.places;this.setState({google:this.state.google,selectedPlace:null,selectedPlaceDetails:null,places:t,filteredPlaces:this.state.places.filter(function(t){return!(e.length>0)||t.name.toLowerCase().includes(e.toLowerCase())}),showingError:!1})}},{key:"fetchDetails",value:function(e){var t={placeId:e.place_id,fields:["name","rating","formatted_phone_number","formatted_address","photos"]},a=this.state.google.mapProps.google,l=this.state.google.map;return new Promise(function(e,n){new a.maps.places.PlacesService(l).getDetails(t,function(t,l){l===a.maps.places.PlacesServiceStatus.OK?e(t):n(l)})})}},{key:"fetchWiki",value:function(e){var t=encodeURIComponent(e.name);return fetch("https://en.wikipedia.org/w/api.php?action=opensearch&search=".concat(t,"&limit=10&namespace=0&origin=*&format=json")).then(function(e){return e.json()}).then(function(e){return new Promise(function(t,a){return e.length>3&&e[1].length>0?t({wikiDescription:e[2][0],wikiUrl:e[3][0]}):t({wikiDescription:"",wikiUrl:""})})})}},{key:"onPlaceSelected",value:function(e){var t=this,a=this.state.places,l=this.state.filteredPlaces;if(this.setState({google:this.state.google,selectedPlace:e,selectedPlaceDetails:null,places:a,filteredPlaces:l,showingError:!1,sidebarOpen:this.state.sidebarOpen}),e){var n=this.fetchDetails(e),r=this.fetchWiki(e);Promise.all([n,r]).then(function(n){var r=Object.assign({},n[0],n[1]);t.setState({google:t.state.google,selectedPlace:e,selectedPlaceDetails:r,places:a,filteredPlaces:l,showingError:!1,sidebarOpen:t.state.sidebarOpen})}).catch(function(e){console.log(e)})}}},{key:"onMenuClick",value:function(){this.setState(function(e){return e.sidebarOpen=!e.sidebarOpen,e})}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"header"},n.a.createElement(v,{sidebarOpen:this.state.sidebarOpen,onMenuClick:this.onMenuClick.bind(this)}),n.a.createElement("h1",null,"London's Museums")),n.a.createElement(u,{sidebarOpen:this.state.sidebarOpen,selectedPlace:this.state.selectedPlace,places:this.state.filteredPlaces,onQueryChanged:this.updateQuery.bind(this),onPlaceSelected:this.onPlaceSelected.bind(this)}),n.a.createElement(g,{selectedPlace:this.state.selectedPlace,selectedPlaceDetails:this.state.selectedPlaceDetails,places:this.state.filteredPlaces,onMapLoaded:this.onMapLoaded.bind(this),onPlaceSelected:this.onPlaceSelected.bind(this)}))}}]),t}(l.Component),T=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(n.a.createElement(k,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/neighborhoodMap",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/neighborhoodMap","/service-worker.js");T?(function(e,t){fetch(e).then(function(a){var l=a.headers.get("content-type");404===a.status||null!=l&&-1===l.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):w(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):w(t,e)})}}()},78:function(e,t,a){e.exports=a.p+"static/media/icon_Wikipedia.c7915b4b.png"},80:function(e,t,a){e.exports=a(197)},85:function(e,t,a){},86:function(e,t,a){}},[[80,1,2]]]);
//# sourceMappingURL=main.8d8f38cc.chunk.js.map